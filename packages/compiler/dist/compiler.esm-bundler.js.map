{"version":3,"file":"compiler.esm-bundler.js","sources":["../src/token-reader.ts","../src/tokenizer.ts","../src/ast.ts","../src/transform.ts","../src/compiler.ts","../src/index.ts"],"sourcesContent":["import { JSXTokenizer } from \"./tokenizer\";\r\n\r\nexport class TokenReader {\r\n  tokens: JSXTokenizer.IToken[] = [];\r\n  pos: number = 0;\r\n\r\n  constructor(tokens: JSXTokenizer.IToken[]) {\r\n    this.tokens = tokens;\r\n  }\r\n\r\n  loadTokens(tokens: JSXTokenizer.IToken[]) {\r\n    this.tokens = tokens;\r\n    this.pos = 0;\r\n  }\r\n\r\n  read(): JSXTokenizer.IToken | null {\r\n    if (this.pos < this.tokens.length) {\r\n      return this.tokens[this.pos++];\r\n    }\r\n    return null;\r\n  }\r\n\r\n  peek(): JSXTokenizer.IToken | null {\r\n    if (this.pos < this.tokens.length) {\r\n      return this.tokens[this.pos];\r\n    }\r\n    return null;\r\n  }\r\n\r\n  unread(): void {\r\n    if (this.pos > 0) {\r\n      this.pos -= 1;\r\n    }\r\n  }\r\n}\r\n","export module JSXTokenizer {\r\n  export interface ITokenizerConstructor {\r\n    new(): ITokenizer;\r\n  }\r\n\r\n  export type TokenizerParamter = string;\r\n\r\n  export interface IToken {\r\n    type: Symbol | null;\r\n    value: string;\r\n  }\r\n\r\n  export interface IStateExcutor extends Function {\r\n    (char: string): IStateExcutor | undefined;\r\n  }\r\n\r\n  export type REType = {\r\n    [props: string]: RegExp;\r\n  };\r\n\r\n  export interface ITokenizer {\r\n    currentToken: IToken;\r\n    tokens: IToken[];\r\n    RE: REType;\r\n    run(input: JSXTokenizer.TokenizerParamter): IToken[];\r\n    searchBeginTagStart: IStateExcutor;\r\n    searchJSXIdentifier: IStateExcutor;\r\n    searchFirstCommentBar: IStateExcutor;\r\n    searchSecondCommentBar: IStateExcutor;\r\n    searchCommentContent: IStateExcutor;\r\n    searchCommentEnd: IStateExcutor;\r\n    searchJSXAttributeKey: IStateExcutor;\r\n    foundBackFlashInAttribute: IStateExcutor;\r\n    searchJSXAttributeValue: IStateExcutor;\r\n    foundAttributeQuote: IStateExcutor;\r\n    foundJSXBeginTagEnd: IStateExcutor;\r\n    resetCurrentToken(): void;\r\n    emit(token: IToken): void;\r\n    pop(): IToken | undefined;\r\n  }\r\n\r\n  export const TagStartType = Symbol(\"TagStartType\");\r\n  export const JSXIdentifierType = Symbol(\"JSXIdentifier\");\r\n  export const JSXAttributeKey = Symbol(\"JSXAttributeKey\");\r\n  export const Equator = Symbol(\"Equator\");\r\n  export const JSXAttributeValue = Symbol(\"JSXAttributeValue\");\r\n  export const TagEndType = Symbol(\"TagEndType\");\r\n  export const BackFlash = Symbol(\"BackFlash\");\r\n  export const Text = Symbol(\"Text\");\r\n  export const Comment = Symbol(\"Comment\");\r\n}\r\n\r\nexport class Tokenizer implements JSXTokenizer.ITokenizer {\r\n  tokens: JSXTokenizer.IToken[] = [];\r\n  currentQuote: string | undefined;\r\n  currentToken: JSXTokenizer.IToken = {\r\n    type: Symbol(\"INIT\"),\r\n    value: \"\",\r\n  };\r\n  RE: JSXTokenizer.REType = {\r\n    LETTERS: /[a-zA-Z0-9\\-]/,\r\n    ATTRIBUTEKEY: /[a-zA-Z0-9-@:$\\.]/,\r\n    ATTRIBUTEVALUE: /[^\\\"\\'\\`]/,\r\n    Text: /[^>]/,\r\n    commentContent: /[^-]/,\r\n    Quote: /['\"`]/,\r\n  };\r\n\r\n  run(input: JSXTokenizer.TokenizerParamter): JSXTokenizer.IToken[] {\r\n    this.tokens = [];\r\n    let state: JSXTokenizer.IStateExcutor | void = this.searchBeginTagStart;\r\n    for (const char of input) {\r\n      if (state !== undefined) {\r\n        // 忽略换行\r\n        if (/\\r\\n|\\r|\\n/.test(char)) continue;\r\n        state = state && state.call(this, char);\r\n      }\r\n    }\r\n    console.log(\"Tokens Generate Success!\");\r\n\r\n    return this.tokens;\r\n  }\r\n\r\n  searchBeginTagStart(char: string): JSXTokenizer.IStateExcutor {\r\n    if (char === \"<\") {\r\n      this.emit(this.currentToken);\r\n      this.emit({\r\n        type: JSXTokenizer.TagStartType,\r\n        value: char,\r\n      });\r\n      this.resetCurrentToken();\r\n      return this.searchJSXIdentifier;\r\n    }\r\n\r\n    if (this.RE.Quote.test(char)) {\r\n      this.currentToken.type = JSXTokenizer.Text;\r\n      this.currentToken.value += `\\\\${char}`;\r\n      return this.searchBeginTagStart;\r\n    }\r\n\r\n    if (this.RE.Text.test(char)) {\r\n      this.currentToken.type = JSXTokenizer.Text;\r\n      this.currentToken.value += char;\r\n      return this.searchBeginTagStart;\r\n    }\r\n\r\n    throw TypeError(\"UnExcepted Error\");\r\n  }\r\n\r\n  searchJSXIdentifier(char: string): JSXTokenizer.IStateExcutor {\r\n    if (this.RE.LETTERS.test(char)) {\r\n      this.currentToken.type = JSXTokenizer.JSXIdentifierType;\r\n      this.currentToken.value += char;\r\n      return this.searchJSXIdentifier;\r\n    }\r\n    if (char === \" \") {\r\n      this.emit(this.currentToken);\r\n      this.resetCurrentToken();\r\n      return this.searchJSXAttributeKey;\r\n    }\r\n    if (char === \"/\") {\r\n      this.emit({\r\n        type: JSXTokenizer.BackFlash,\r\n        value: char,\r\n      });\r\n      return this.searchJSXIdentifier;\r\n    }\r\n    if (char === \">\") {\r\n      this.emit(this.currentToken);\r\n      this.resetCurrentToken();\r\n      this.emit({\r\n        type: JSXTokenizer.TagEndType,\r\n        value: char,\r\n      });\r\n      return this.searchBeginTagStart;\r\n    }\r\n    if (char === \"!\") {\r\n      let lastToken = this.pop();\r\n      if (\r\n        lastToken !== undefined &&\r\n        lastToken.type !== JSXTokenizer.TagStartType\r\n      ) {\r\n        throw TypeError(`UnExcepted char ${char}`);\r\n      }\r\n      this.currentToken = {\r\n        type: JSXTokenizer.Comment,\r\n        value: \"<!\",\r\n      };\r\n      return this.searchFirstCommentBar;\r\n    }\r\n\r\n    throw TypeError(\"UnExcepted Error\");\r\n  }\r\n\r\n  searchFirstCommentBar(char: string): JSXTokenizer.IStateExcutor {\r\n    if (char === \"-\") {\r\n      this.currentToken.value += char;\r\n      return this.searchSecondCommentBar;\r\n    }\r\n    throw TypeError(\"UnExcepted Error\");\r\n  }\r\n\r\n  searchSecondCommentBar(char: string): JSXTokenizer.IStateExcutor {\r\n    if (char === \"-\") {\r\n      this.currentToken.value += char;\r\n      return this.searchCommentContent;\r\n    }\r\n    throw TypeError(\"UnExcepted Error\");\r\n  }\r\n\r\n  searchCommentContent(char: string): JSXTokenizer.IStateExcutor {\r\n    if (this.RE.commentContent.test(char)) {\r\n      this.currentToken.value += char;\r\n      return this.searchCommentContent;\r\n    } else if (char === \"-\") {\r\n      this.currentToken.value += char;\r\n      return this.searchCommentEnd;\r\n    }\r\n\r\n    throw TypeError(\"Unexpeted Error\");\r\n  }\r\n\r\n  searchCommentEnd(char: string): JSXTokenizer.IStateExcutor {\r\n    if (char === \"-\") {\r\n      this.currentToken.value += char;\r\n      return this.searchCommentEnd;\r\n    } else if (char === \">\") {\r\n      this.currentToken.value += char;\r\n      this.emit(this.currentToken);\r\n      this.resetCurrentToken();\r\n      return this.searchBeginTagStart;\r\n    } else {\r\n      this.currentToken.value += char;\r\n      return this.searchCommentContent;\r\n    }\r\n\r\n    throw TypeError(\"Unexpeted Error\");\r\n  }\r\n\r\n  searchJSXAttributeKey(char: string): JSXTokenizer.IStateExcutor {\r\n    if (char === \" \") {\r\n      this.emit(this.currentToken);\r\n      this.resetCurrentToken();\r\n      return this.searchJSXAttributeKey;\r\n    }\r\n    if (this.RE.ATTRIBUTEKEY.test(char)) {\r\n      this.currentToken.type = JSXTokenizer.JSXAttributeKey;\r\n      this.currentToken.value += char;\r\n      return this.searchJSXAttributeKey;\r\n    }\r\n\r\n    if (char === \"=\") {\r\n      this.emit(this.currentToken);\r\n      this.resetCurrentToken();\r\n      this.emit({\r\n        type: JSXTokenizer.Equator,\r\n        value: char,\r\n      });\r\n      return this.searchJSXAttributeValue;\r\n    }\r\n\r\n    if (char === \">\") {\r\n      this.emit(this.currentToken);\r\n      this.resetCurrentToken();\r\n      this.emit({\r\n        type: JSXTokenizer.TagEndType,\r\n        value: char,\r\n      });\r\n      return this.foundJSXBeginTagEnd;\r\n    }\r\n\r\n    if (char === \"/\") {\r\n      this.emit({\r\n        type: JSXTokenizer.BackFlash,\r\n        value: char,\r\n      });\r\n      return this.foundBackFlashInAttribute;\r\n    }\r\n    throw TypeError(\"UnExcepted Error\");\r\n  }\r\n\r\n  foundBackFlashInAttribute(char: string): JSXTokenizer.IStateExcutor {\r\n    if (char === \">\") {\r\n      this.emit({\r\n        type: JSXTokenizer.TagEndType,\r\n        value: char,\r\n      });\r\n      return this.foundJSXBeginTagEnd;\r\n    }\r\n    throw TypeError(\"Should Be > after /\");\r\n  }\r\n\r\n  @jumpSpace\r\n  searchJSXAttributeValue(char: string): JSXTokenizer.IStateExcutor {\r\n    if (this.RE.Quote.test(char)) {\r\n      this.currentQuote = char;\r\n      this.currentToken.type = JSXTokenizer.JSXAttributeValue;\r\n      this.currentToken.value = \"\";\r\n      return this.foundAttributeQuote;\r\n    }\r\n\r\n    throw TypeError(\"UnExcepted Error\");\r\n  }\r\n\r\n  foundAttributeQuote(char: string): JSXTokenizer.IStateExcutor {\r\n    if (this.RE.ATTRIBUTEVALUE.test(char)) {\r\n      this.currentToken.type = JSXTokenizer.JSXAttributeValue;\r\n      this.currentToken.value += char;\r\n      return this.foundAttributeQuote;\r\n    }\r\n\r\n    if (char === this.currentQuote) {\r\n      this.currentToken.type = JSXTokenizer.JSXAttributeValue;\r\n      // this.currentToken.value += char;\r\n      this.emit(this.currentToken, true);\r\n      this.resetCurrentToken();\r\n      return this.searchJSXAttributeKey;\r\n    }\r\n\r\n    if (this.RE.Quote.test(char)) {\r\n      this.currentToken.value += `\\\\${char}`;\r\n      return this.foundAttributeQuote;\r\n    }\r\n    throw TypeError(\"UnExcepted Error\");\r\n  }\r\n\r\n  foundJSXBeginTagEnd(char: string): JSXTokenizer.IStateExcutor {\r\n    if (char === \"<\") {\r\n      this.emit(this.currentToken);\r\n      this.currentToken = {\r\n        type: JSXTokenizer.TagStartType,\r\n        value: char,\r\n      };\r\n      this.emit(this.currentToken);\r\n      this.resetCurrentToken();\r\n      return this.searchJSXIdentifier;\r\n    }\r\n\r\n    if (this.RE.Quote.test(char)) {\r\n      this.currentToken.type = JSXTokenizer.Text;\r\n      this.currentToken.value += `\\\\${char}`;\r\n      return this.foundJSXBeginTagEnd;\r\n    }\r\n    this.currentToken.type = JSXTokenizer.Text;\r\n    this.currentToken.value += char;\r\n    return this.foundJSXBeginTagEnd;\r\n  }\r\n\r\n  resetCurrentToken() {\r\n    if (this.currentToken === null) return;\r\n    this.currentToken = {\r\n      type: Symbol(\"INIT\"),\r\n      value: \"\",\r\n    };\r\n  }\r\n\r\n  emit(token: JSXTokenizer.IToken, force?: boolean): void {\r\n    if ((!token.value || !token.value.trim()) && !force) return;\r\n\r\n    this.tokens.push(token);\r\n  }\r\n\r\n  pop(): JSXTokenizer.IToken | undefined {\r\n    return this.tokens.pop();\r\n  }\r\n}\r\n\r\nfunction jumpSpace(\r\n  target: any,\r\n  propertyKey: string,\r\n  descriptor: PropertyDescriptor\r\n) {\r\n  let method = descriptor.value;\r\n  let jumpSpaceFunc = function (this: JSXTokenizer.ITokenizer, char: string) {\r\n    if (char === \" \") return jumpSpaceFunc;\r\n    return method.call(this, char);\r\n  };\r\n  descriptor.value = jumpSpaceFunc;\r\n}\r\n\r\nexport function createTokenizer(\r\n  Tokenizer: JSXTokenizer.ITokenizerConstructor\r\n): JSXTokenizer.ITokenizer {\r\n  return new Tokenizer();\r\n}\r\n","import { TokenReader } from \"./token-reader\";\r\nimport { JSXTokenizer } from \"./tokenizer\";\r\n\r\nexport module AST {\r\n  export type ASTNodeType =\r\n    | typeof ASTNodeType[keyof typeof ASTNodeType]\r\n    | typeof FinalTokenType[keyof typeof FinalTokenType];\r\n\r\n  export interface ASTNode {\r\n    type: ASTNodeType;\r\n    value?: string;\r\n    children?: ASTNode[];\r\n  }\r\n\r\n  export interface ASTElementNode extends ASTNode {\r\n    elementType?: \"Text\" | \"Element\" | \"Comment\" | \"Program\";\r\n    closeSelf?: Boolean | String;\r\n  }\r\n\r\n  // 非终结符\r\n  export const ASTNodeType = {\r\n    Program: Symbol(\"Program\"),\r\n    Expr: Symbol(\"Expr\"),\r\n    TagHead: Symbol(\"TagHead\"),\r\n    TagHeadStart: Symbol(\"TagHeadStart\"),\r\n    Attribute: Symbol(\"Attribute\"),\r\n    TagHeadEnd: Symbol(\"TagHeadEnd\"),\r\n    TagTail: Symbol(\"TagTail\"),\r\n  };\r\n\r\n  // 终结符\r\n  export const FinalTokenType = {\r\n    Text: Symbol(\"Text\"),\r\n    Comment: Symbol(\"Comment\"),\r\n    LeftBracket: Symbol(\"LeftBracket\"),\r\n    Identifier: Symbol(\"Identifier\"),\r\n    AttributeKey: Symbol(\"AttributeKey\"),\r\n    Equator: Symbol(\"Equator\"),\r\n    AttributeValue: Symbol(\"AttributeValue\"),\r\n    BackFlash: Symbol(\"BackFlash\"),\r\n    RightBracket: Symbol(\"RightBracket\"),\r\n  };\r\n\r\n  type UnFinalTokenHandlerReturnType = Boolean;\r\n  type UnFinalTokenHandler = () => UnFinalTokenHandlerReturnType;\r\n\r\n  type UnFinalToken =\r\n    | \"Program\"\r\n    | \"Expr\"\r\n    | \"TagHead\"\r\n    | \"TagHeadStart\"\r\n    | \"Attribute\"\r\n    | \"TagHeadEnd\"\r\n    | \"TagTail\";\r\n\r\n  export interface IParse extends Record<UnFinalToken, UnFinalTokenHandler> {\r\n    tokenReader: TokenReader;\r\n    ast: ASTElementNode;\r\n    closeSelf: Boolean;\r\n    createAST(tokens: JSXTokenizer.IToken[]): ASTNode;\r\n  }\r\n\r\n  export class Parse implements IParse {\r\n    tokenReader: TokenReader = new TokenReader([]);\r\n    ast: ASTElementNode;\r\n    currentNode!: ASTElementNode;\r\n    parentNode!: ASTElementNode;\r\n    currentToken!: JSXTokenizer.IToken;\r\n    closeSelf: Boolean = false;\r\n    identifierStack: string[] = [];\r\n\r\n    constructor(tokens: JSXTokenizer.IToken[]) {\r\n      this.tokenReader.loadTokens(tokens);\r\n      this.ast = this.toAST();\r\n    }\r\n\r\n    createAST(tokens: JSXTokenizer.IToken[]) {\r\n      this.tokenReader.loadTokens(tokens);\r\n      return this.toAST();\r\n    }\r\n\r\n    createASTNode(\r\n      type: ASTNodeType,\r\n      children: ASTElementNode[] | undefined,\r\n      value?: string\r\n    ): ASTElementNode {\r\n      let node: ASTElementNode = {\r\n        type: <any>type,\r\n      };\r\n      if (children !== undefined) node.children = children;\r\n      if (value !== undefined) node.value = value;\r\n      return node;\r\n    }\r\n\r\n    setCurrentToken(token: JSXTokenizer.IToken | null) {\r\n      if (token !== null) {\r\n        this.currentToken = token;\r\n      }\r\n    }\r\n\r\n    toAST(): ASTNode {\r\n      this.Program();\r\n      return this.ast;\r\n    }\r\n\r\n    checkIdentifier() {\r\n      if (this.closeSelf) return;\r\n\r\n      let lastIdentifier = this.identifierStack.pop();\r\n      if (this.tokenReader.peek()?.value !== lastIdentifier) {\r\n        throw TypeError(\r\n          `Unexpeted TagTail Identifier ${this.tokenReader.peek()?.value\r\n          } whitch is not match ${lastIdentifier}`\r\n        );\r\n      }\r\n    }\r\n\r\n    Program(): UnFinalTokenHandlerReturnType {\r\n      let root = this.createASTNode(ASTNodeType.Program, []);\r\n      this.currentNode = root;\r\n      this.parentNode = root;\r\n      this.ast = root;\r\n      if (!this.tokenReader.tokens.length) return false;\r\n      if (this.Expr()) {\r\n        console.log(\"AST Generate Success!\");\r\n        return true;\r\n      }\r\n      throw TypeError(\"AST Generate Failed!\");\r\n    }\r\n\r\n    Expr(): UnFinalTokenHandlerReturnType {\r\n      this.setCurrentToken(this.tokenReader.peek());\r\n      let oldParent = this.parentNode;\r\n      let node = this.createASTNode(ASTNodeType.Expr, []);\r\n      this.parentNode.children?.push(node);\r\n      this.parentNode = node;\r\n\r\n      if (this.currentToken.type === JSXTokenizer.Comment) {\r\n        let textNode = this.createASTNode(\r\n          FinalTokenType.Comment,\r\n          undefined,\r\n          this.currentToken.value\r\n        );\r\n        node.elementType = \"Comment\";\r\n        this.parentNode.children?.push(textNode);\r\n        this.tokenReader.read();\r\n        this.parentNode = oldParent;\r\n        this.Expr();\r\n        return true;\r\n      } else if (this.currentToken.type === JSXTokenizer.Text) {\r\n        let textNode = this.createASTNode(\r\n          FinalTokenType.Text,\r\n          undefined,\r\n          this.currentToken.value\r\n        );\r\n        node.elementType = \"Text\";\r\n        this.parentNode.children?.push(textNode);\r\n        this.tokenReader.read();\r\n        this.parentNode = oldParent;\r\n        this.Expr();\r\n        return true;\r\n      } else if (this.TagHead()) {\r\n        node.elementType = \"Element\";\r\n        if (this.closeSelf) {\r\n          node.closeSelf = true;\r\n          this.parentNode = oldParent;\r\n          this.Expr();\r\n          return true;\r\n        }\r\n        node.closeSelf = false;\r\n        this.parentNode = node;\r\n        if (this.Expr()) {\r\n          this.parentNode = node;\r\n          if (this.TagTail()) {\r\n            this.parentNode = oldParent;\r\n            this.Expr();\r\n            return true;\r\n          }\r\n          oldParent.children?.pop();\r\n          return false;\r\n        } else {\r\n          this.parentNode = node;\r\n          if (this.TagTail()) {\r\n            this.parentNode = oldParent;\r\n            this.Expr();\r\n            return true;\r\n          }\r\n        }\r\n      }\r\n      oldParent.children?.pop();\r\n      return false;\r\n    }\r\n\r\n    TagHead(): UnFinalTokenHandlerReturnType {\r\n      this.closeSelf = false;\r\n      this.setCurrentToken(this.tokenReader.peek());\r\n      let node = this.createASTNode(ASTNodeType.TagHead, []);\r\n      let oldParent = this.parentNode;\r\n      this.parentNode.children?.push(node);\r\n      this.parentNode = node;\r\n\r\n      if (this.TagHeadStart()) {\r\n        this.parentNode = node;\r\n        if (this.Attribute()) {\r\n          this.parentNode = node;\r\n          if (this.TagHeadEnd()) {\r\n            node.closeSelf = !!this.closeSelf;\r\n            return true;\r\n          }\r\n          oldParent.children?.pop();\r\n          return false;\r\n        } else {\r\n          this.parentNode = node;\r\n          if (this.TagHeadEnd()) {\r\n            node.closeSelf = !!this.closeSelf;\r\n            return true;\r\n          }\r\n        }\r\n      }\r\n      oldParent.children?.pop();\r\n      return false;\r\n    }\r\n\r\n    TagHeadStart(): UnFinalTokenHandlerReturnType {\r\n      this.setCurrentToken(this.tokenReader.peek());\r\n      let node = this.createASTNode(ASTNodeType.TagHeadStart, []);\r\n      this.parentNode.children?.push(node);\r\n      this.parentNode = node;\r\n\r\n      if (this.currentToken.value === \"<\") {\r\n        // this.parentNode.children?.push(\r\n        //   this.createASTNode(\r\n        //     FinalTokenType.LeftBracket,\r\n        //     undefined,\r\n        //     this.currentToken.value\r\n        //   )\r\n        // );\r\n        this.tokenReader.read();\r\n        this.setCurrentToken(this.tokenReader.peek());\r\n        if (this.currentToken.type === JSXTokenizer.JSXIdentifierType) {\r\n          this.identifierStack.push(this.currentToken.value);\r\n\r\n          this.parentNode.children?.push(\r\n            this.createASTNode(\r\n              FinalTokenType.Identifier,\r\n              undefined,\r\n              this.currentToken.value\r\n            )\r\n          );\r\n          this.tokenReader.read();\r\n          return true;\r\n        }\r\n        this.tokenReader.unread();\r\n        return false;\r\n      }\r\n      return false;\r\n    }\r\n\r\n    Attribute(): UnFinalTokenHandlerReturnType {\r\n      this.setCurrentToken(this.tokenReader.peek());\r\n      let oldParent = this.parentNode;\r\n      let node = this.createASTNode(ASTNodeType.Attribute, []);\r\n      this.parentNode.children?.push(node);\r\n      this.parentNode = node;\r\n\r\n      if (this.currentToken.type === JSXTokenizer.JSXAttributeKey) {\r\n        this.parentNode.children?.push(\r\n          this.createASTNode(\r\n            FinalTokenType.AttributeKey,\r\n            undefined,\r\n            this.currentToken.value\r\n          )\r\n        );\r\n        this.tokenReader.read();\r\n        if (this.tokenReader.peek()?.type === JSXTokenizer.Equator) {\r\n          // this.parentNode.children?.push(\r\n          //   this.createASTNode(\r\n          //     FinalTokenType.Equator,\r\n          //     undefined,\r\n          //     this.tokenReader.peek()?.value\r\n          //   )\r\n          // );\r\n          this.tokenReader.read();\r\n          if (\r\n            this.tokenReader.peek()?.type === JSXTokenizer.JSXAttributeValue\r\n          ) {\r\n            this.parentNode.children?.push(\r\n              this.createASTNode(\r\n                FinalTokenType.AttributeValue,\r\n                undefined,\r\n                this.tokenReader.peek()?.value\r\n              )\r\n            );\r\n            this.tokenReader.read();\r\n            this.parentNode = oldParent;\r\n            if (this.Attribute()) return true;\r\n            return true;\r\n          }\r\n          this.tokenReader.unread(); // 把 = 退掉\r\n          this.tokenReader.unread(); // 把 AttributeKey 退掉\r\n          oldParent.children?.pop();\r\n          return false;\r\n        }\r\n        this.parentNode = oldParent;\r\n        this.Attribute();\r\n        return true;\r\n      }\r\n      oldParent.children?.pop();\r\n      return false;\r\n    }\r\n\r\n    TagHeadEnd(): UnFinalTokenHandlerReturnType {\r\n      this.setCurrentToken(this.tokenReader.peek());\r\n      let node = this.createASTNode(ASTNodeType.TagHeadEnd, []);\r\n      this.parentNode.children?.push(node);\r\n      this.parentNode = node;\r\n      if (this.currentToken.type === JSXTokenizer.BackFlash) {\r\n        // this.parentNode.children?.push(\r\n        //   this.createASTNode(\r\n        //     FinalTokenType.BackFlash,\r\n        //     undefined,\r\n        //     this.currentToken.value\r\n        //   )\r\n        // );\r\n        this.tokenReader.read();\r\n        if (this.tokenReader.peek()?.value === \">\") {\r\n          // this.parentNode.children?.push(\r\n          //   this.createASTNode(\r\n          //     FinalTokenType.RightBracket,\r\n          //     undefined,\r\n          //     this.tokenReader.peek()?.value\r\n          //   )\r\n          // );\r\n          this.tokenReader.read();\r\n          this.closeSelf = true;\r\n          this.identifierStack.pop();\r\n          return true;\r\n        }\r\n        this.tokenReader.unread();\r\n        return false;\r\n      }\r\n      if (this.tokenReader.peek()?.value === \">\") {\r\n        // this.parentNode.children?.push(\r\n        //   this.createASTNode(\r\n        //     FinalTokenType.RightBracket,\r\n        //     undefined,\r\n        //     this.tokenReader.peek()?.value\r\n        //   )\r\n        // );\r\n        this.tokenReader.read();\r\n        return true;\r\n      }\r\n      return false;\r\n    }\r\n\r\n    TagTail(): UnFinalTokenHandlerReturnType {\r\n      this.setCurrentToken(this.tokenReader.peek());\r\n      let node = this.createASTNode(ASTNodeType.TagTail, []);\r\n      this.parentNode.children?.push(node);\r\n      this.parentNode = node;\r\n      if (this.currentToken.value === \"<\") {\r\n        // this.parentNode.children?.push(\r\n        //   this.createASTNode(\r\n        //     FinalTokenType.LeftBracket,\r\n        //     undefined,\r\n        //     this.currentToken.value\r\n        //   )\r\n        // );\r\n        this.tokenReader.read();\r\n        if (this.tokenReader.peek()?.type === JSXTokenizer.BackFlash) {\r\n          // this.parentNode.children?.push(\r\n          //   this.createASTNode(\r\n          //     FinalTokenType.BackFlash,\r\n          //     undefined,\r\n          //     this.tokenReader.peek()?.value\r\n          //   )\r\n          // );\r\n          this.tokenReader.read();\r\n          if (\r\n            this.tokenReader.peek()?.type === JSXTokenizer.JSXIdentifierType\r\n          ) {\r\n            this.checkIdentifier();\r\n            this.parentNode.children?.push(\r\n              this.createASTNode(\r\n                FinalTokenType.Identifier,\r\n                undefined,\r\n                this.tokenReader.peek()?.value\r\n              )\r\n            );\r\n            this.tokenReader.read();\r\n            if (this.tokenReader.peek()?.value === \">\") {\r\n              // this.parentNode.children?.push(\r\n              //   this.createASTNode(\r\n              //     FinalTokenType.RightBracket,\r\n              //     undefined,\r\n              //     this.tokenReader.peek()?.value\r\n              //   )\r\n              // );\r\n              this.tokenReader.read();\r\n              return true;\r\n            }\r\n            this.tokenReader.unread();\r\n            this.tokenReader.unread();\r\n            this.tokenReader.unread();\r\n            return false;\r\n          }\r\n          this.tokenReader.unread();\r\n          this.tokenReader.unread();\r\n          return false;\r\n        }\r\n        this.tokenReader.unread();\r\n        return false;\r\n      }\r\n      return false;\r\n    }\r\n  }\r\n}\r\n","import { AST } from \"./ast\";\r\nexport module Transform {\r\n  const extractASTParserNodeSet: {\r\n    [prop: string]: boolean;\r\n  } = {};\r\n  [\r\n    AST.ASTNodeType.TagHead,\r\n    AST.ASTNodeType.TagTail,\r\n    AST.ASTNodeType.TagHeadStart,\r\n    AST.ASTNodeType.TagHeadEnd,\r\n  ].forEach((key) => {\r\n    extractASTParserNodeSet[key.toString()] = true;\r\n  });\r\n\r\n  export interface ITransformer {\r\n    extractASTParserNode(node: AST.ASTNode): AST.ASTNode;\r\n    transform2JSXElement(node: AST.ASTNode): JSXElement;\r\n    createJSXElement(\r\n      identifier: string,\r\n      Attributes: JSXAttribute[],\r\n      children: JSXElement[],\r\n      ast: AST.ASTElementNode\r\n    ): JSXElement;\r\n  }\r\n\r\n  export interface JSXElement\r\n    extends Omit<AST.ASTElementNode, keyof AST.ASTNode> {\r\n    identifier: string;\r\n    Attributes: JSXAttribute[];\r\n    children?: JSXElement[];\r\n    value?: string;\r\n  }\r\n\r\n  export interface JSXAttribute {\r\n    key: string;\r\n    value: string | boolean;\r\n  }\r\n\r\n  export class Transfomer {\r\n    createJSXElement(\r\n      identifier: string,\r\n      Attributes: JSXAttribute[],\r\n      children: JSXElement[],\r\n      ast: AST.ASTElementNode\r\n    ): JSXElement {\r\n      let node: JSXElement = {\r\n        identifier,\r\n        Attributes,\r\n        children,\r\n        elementType: ast.elementType,\r\n        closeSelf: ast.closeSelf,\r\n      };\r\n\r\n      return node;\r\n    }\r\n\r\n    transform2JSXElement(node: AST.ASTNode): JSXElement {\r\n      let identifier = \"Program\",\r\n        Attributes: JSXAttribute[] = [],\r\n        children: JSXElement[] = [];\r\n      let root = this.createJSXElement(identifier, Attributes, children, node);\r\n\r\n      function buildJSXElement(\r\n        this: ITransformer,\r\n        node: AST.ASTNode,\r\n        parent: JSXElement\r\n      ) {\r\n        if (node.type === AST.ASTNodeType.Expr) {\r\n          let identifier: string,\r\n            Attributes: JSXAttribute[] = [],\r\n            children: JSXElement[] = [],\r\n            element: JSXElement;\r\n\r\n          node.children?.forEach((child) => {\r\n            if (child.type === AST.FinalTokenType.Identifier) {\r\n              identifier = child.value!;\r\n              element =\r\n                element ||\r\n                this.createJSXElement(identifier, Attributes, children, node);\r\n              return;\r\n            }\r\n            if (child.type === AST.ASTNodeType.Attribute) {\r\n              let attr: JSXAttribute = {\r\n                key: \"\",\r\n                value: \"\",\r\n              };\r\n              child.children?.forEach((item) => {\r\n                if (item.type === AST.FinalTokenType.AttributeKey) {\r\n                  attr.key = item.value!;\r\n                  return;\r\n                }\r\n\r\n                if (item.type === AST.FinalTokenType.AttributeValue) {\r\n                  attr.value = item.value!;\r\n                  return;\r\n                }\r\n              });\r\n              attr.value = attr.value || true;\r\n              Attributes.push(attr);\r\n              return;\r\n            }\r\n            if (child.type === AST.FinalTokenType.Comment) {\r\n              children.push({\r\n                identifier: \"[[Comment]]\",\r\n                Attributes: [],\r\n                value: child.value,\r\n              });\r\n              return;\r\n            }\r\n            if (child.type === AST.FinalTokenType.Text) {\r\n              element = this.createJSXElement(\r\n                '[[Text]]',\r\n                Attributes,\r\n                children,\r\n                node\r\n              );\r\n              delete element.children;\r\n              element.value = child.value;\r\n              return;\r\n            }\r\n            if (child.type === AST.ASTNodeType.Expr) {\r\n              buildJSXElement.call(this, child, element);\r\n            }\r\n          });\r\n\r\n          if (!parent.children) throw TypeError(\"parent should have children\");\r\n          if (!element!)\r\n            element = this.createJSXElement(\r\n              identifier!,\r\n              Attributes,\r\n              children,\r\n              node\r\n            );\r\n          parent.children.push(element);\r\n        }\r\n      }\r\n\r\n      node.children?.forEach((item) => buildJSXElement.call(this, item, root));\r\n      root.elementType = 'Program';\r\n      return root;\r\n    }\r\n\r\n    extractASTParserNode(node: AST.ASTNode): AST.ASTNode {\r\n      let extractedNode = Object.assign({}, node);\r\n\r\n      function extract(child: AST.ASTNode): AST.ASTNode[] {\r\n        if (extractASTParserNodeSet[child.type.toString()]) {\r\n          if (!child.children) return [child];\r\n          return child.children.map((item) => extract(item)).flat();\r\n        }\r\n        if (!child.children) return [child];\r\n        child.children = child.children.map((item) => extract(item)).flat();\r\n        return [child];\r\n      }\r\n      if (!node.children) return node;\r\n      extractedNode.children = node.children\r\n        .map((item) => extract(item))\r\n        .flat();\r\n\r\n      return extractedNode;\r\n    }\r\n  }\r\n}\r\n","import { AST } from \"./ast\";\r\nimport { createTokenizer, JSXTokenizer, Tokenizer } from \"./tokenizer\";\r\nimport { Transform } from \"./transform\";\r\n\r\nexport module JSXCompiler {\r\n  export interface compileFileOptions {\r\n    path: string;\r\n  }\r\n\r\n  export interface ICompiler {\r\n    tokenizer: JSXTokenizer.ITokenizer;\r\n    astParser: AST.IParse;\r\n    transformer: Transform.Transfomer;\r\n    tokens: JSXTokenizer.IToken[];\r\n    ast?: AST.ASTNode;\r\n\r\n    compile(template: string): AST.ASTNode;\r\n    // compileFile(options: compileFileOptions): AST.ASTNode;\r\n  }\r\n\r\n  export class Compiler implements ICompiler {\r\n    tokenizer: JSXTokenizer.ITokenizer = createTokenizer(Tokenizer);\r\n    astParser: AST.IParse = new AST.Parse([]);\r\n    transformer: Transform.Transfomer = new Transform.Transfomer();\r\n    tokens: JSXTokenizer.IToken[] = [];\r\n    ast?: AST.ASTNode;\r\n    jsxElement?: Transform.JSXElement;\r\n\r\n    compile(template: string) {\r\n      console.log(\"================== Compile Start ====================\");\r\n      this.tokens = this.tokenizer.run(template);\r\n      this.ast = this.astParser.createAST(this.tokens);\r\n      this.ast = this.transformer.extractASTParserNode(this.ast);\r\n      this.jsxElement = this.transformer.transform2JSXElement(this.ast);\r\n      console.log(\"Transform Success!\");\r\n      console.log(\"================== Compile Success! ====================\");\r\n      return this.ast;\r\n    }\r\n\r\n    // compileFile(options: compileFileOptions): AST.ASTNode {\r\n    //   let template = fs.readFileSync(options.path).toString();\r\n\r\n    //   return this.compile(template);\r\n    // }\r\n  }\r\n}\r\n","import { AST } from \"./ast\";\r\nimport { JSXCompiler } from \"./compiler\";\r\n\r\nexport { Tokenizer } from \"./tokenizer\";\r\nexport const Parse = AST.Parse;\r\nexport const Compiler = JSXCompiler.Compiler;\r\n\r\n"],"names":[],"mappings":"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"}